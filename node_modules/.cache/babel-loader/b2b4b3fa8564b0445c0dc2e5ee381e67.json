{"ast":null,"code":"'use strict';\n\nvar core = require('@react-pdf-viewer/core');\nvar React = require('react');\nfunction _interopNamespaceDefault(e) {\n  var n = Object.create(null);\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      }\n    });\n  }\n  n.default = e;\n  return Object.freeze(n);\n}\nvar React__namespace = /*#__PURE__*/_interopNamespaceDefault(React);\nexports.ThumbnailDirection = void 0;\n(function (ThumbnailDirection) {\n  ThumbnailDirection[\"Horizontal\"] = \"Horizontal\";\n  ThumbnailDirection[\"Vertical\"] = \"Vertical\";\n})(exports.ThumbnailDirection || (exports.ThumbnailDirection = {}));\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar CoverInner = function (_a) {\n  var doc = _a.doc,\n    getPageIndex = _a.getPageIndex,\n    renderSpinner = _a.renderSpinner,\n    store = _a.store,\n    width = _a.width;\n  var numPages = doc.numPages;\n  var targetPage = getPageIndex ? getPageIndex({\n    numPages: numPages\n  }) : 0;\n  var normalizePage = Math.max(0, Math.min(targetPage, numPages - 1));\n  var initialPagesRotation = store.get('pagesRotation') || new Map();\n  var initialTargetPageRotation = initialPagesRotation.has(normalizePage) ? initialPagesRotation.get(normalizePage) : 0;\n  var _b = React__namespace.useState(''),\n    src = _b[0],\n    setSrc = _b[1];\n  var isMounted = core.useIsMounted();\n  var renderTask = React__namespace.useRef();\n  var _c = React__namespace.useState(store.get('rotation') || 0),\n    rotation = _c[0],\n    setRotation = _c[1];\n  var _d = React__namespace.useState(initialTargetPageRotation),\n    pageRotation = _d[0],\n    setPageRotation = _d[1];\n  var _e = React__namespace.useState(false),\n    isVisible = _e[0],\n    setVisible = _e[1];\n  var handlePagesRotationChanged = function (rotations) {\n    var pageRotation = rotations.has(normalizePage) ? rotations.get(normalizePage) : 0;\n    setPageRotation(pageRotation);\n  };\n  var handleRotationChanged = function (currentRotation) {\n    setRotation(currentRotation);\n  };\n  var handleVisibilityChanged = function (params) {\n    setVisible(params.isVisible);\n  };\n  var containerRef = core.useIntersectionObserver({\n    onVisibilityChanged: handleVisibilityChanged\n  });\n  React__namespace.useEffect(function () {\n    if (!isVisible) {\n      return;\n    }\n    var containerEle = containerRef.current;\n    if (!containerEle) {\n      return;\n    }\n    setSrc('');\n    core.getPage(doc, normalizePage).then(function (page) {\n      var viewport = page.getViewport({\n        scale: 1\n      });\n      var viewportRotation = viewport.rotation;\n      var rotationValue = (viewportRotation + rotation + pageRotation) % 360;\n      var isVertical = Math.abs(rotation + pageRotation) % 180 === 0;\n      var w = isVertical ? viewport.width : viewport.height;\n      var h = isVertical ? viewport.height : viewport.width;\n      var canvas = document.createElement('canvas');\n      var canvasContext = canvas.getContext('2d', {\n        alpha: false\n      });\n      var containerWidth = containerEle.clientWidth;\n      var containerHeight = containerEle.clientHeight;\n      var scaled = width ? width / w : Math.min(containerWidth / w, containerHeight / h);\n      var canvasWidth = scaled * w;\n      var canvasHeight = scaled * h;\n      canvas.height = canvasHeight;\n      canvas.width = canvasWidth;\n      canvas.style.opacity = '0';\n      var renderViewport = page.getViewport({\n        rotation: rotationValue,\n        scale: scaled\n      });\n      renderTask.current = page.render({\n        canvasContext: canvasContext,\n        viewport: renderViewport\n      });\n      renderTask.current.promise.then(function () {\n        isMounted.current && setSrc(canvas.toDataURL());\n        canvas.width = 0;\n        canvas.height = 0;\n      }, function () {});\n    });\n  }, [pageRotation, isVisible]);\n  React__namespace.useEffect(function () {\n    store.subscribe('pagesRotation', handlePagesRotationChanged);\n    store.subscribe('rotation', handleRotationChanged);\n    return function () {\n      store.unsubscribe('pagesRotation', handlePagesRotationChanged);\n      store.unsubscribe('rotation', handleRotationChanged);\n    };\n  }, []);\n  React__namespace.useEffect(function () {\n    return function () {\n      var _a;\n      (_a = renderTask.current) === null || _a === void 0 ? void 0 : _a.cancel();\n    };\n  }, []);\n  return React__namespace.createElement(\"div\", {\n    ref: containerRef,\n    className: \"rpv-thumbnail__cover-inner\",\n    \"data-testid\": \"thumbnail__cover-inner\"\n  }, src ? React__namespace.createElement(\"img\", {\n    className: \"rpv-thumbnail__cover-image\",\n    \"data-testid\": \"thumbnail__cover-image\",\n    src: src\n  }) : React__namespace.createElement(\"div\", {\n    className: \"rpv-thumbnail__cover-loader\",\n    \"data-testid\": \"thumbnail__cover-loader\"\n  }, renderSpinner ? renderSpinner() : React__namespace.createElement(core.Spinner, null)));\n};\nvar Cover = function (_a) {\n  var getPageIndex = _a.getPageIndex,\n    renderSpinner = _a.renderSpinner,\n    store = _a.store,\n    width = _a.width;\n  var _b = React__namespace.useState(store.get('doc')),\n    currentDoc = _b[0],\n    setCurrentDoc = _b[1];\n  var handleDocumentChanged = function (doc) {\n    setCurrentDoc(doc);\n  };\n  React__namespace.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n    };\n  }, []);\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-thumbnail__cover\"\n  }, currentDoc ? React__namespace.createElement(CoverInner, {\n    doc: currentDoc,\n    getPageIndex: getPageIndex,\n    renderSpinner: renderSpinner,\n    store: store,\n    width: width\n  }) : React__namespace.createElement(\"div\", {\n    className: \"rpv-thumbnail__cover-loader\"\n  }, renderSpinner ? renderSpinner() : React__namespace.createElement(core.Spinner, null)));\n};\nvar defaultSpinner = function () {\n  return React__namespace.createElement(core.Spinner, null);\n};\nvar SpinnerContext = React__namespace.createContext({\n  renderSpinner: defaultSpinner\n});\nvar FetchLabels = function (_a) {\n  var children = _a.children,\n    doc = _a.doc;\n  var isMounted = core.useIsMounted();\n  var _b = React__namespace.useState({\n      loading: true,\n      labels: []\n    }),\n    status = _b[0],\n    setStatus = _b[1];\n  React__namespace.useEffect(function () {\n    doc.getPageLabels().then(function (result) {\n      isMounted.current && setStatus({\n        loading: false,\n        labels: result || []\n      });\n    });\n  }, [doc.loadingTask.docId]);\n  return status.loading ? React__namespace.createElement(React__namespace.Fragment, null) : children(status.labels);\n};\nvar scrollToBeVisibleVertically = function (ele, container) {\n  var top = ele.getBoundingClientRect().top - container.getBoundingClientRect().top;\n  var eleHeight = ele.clientHeight;\n  var containerHeight = container.clientHeight;\n  if (top < 0) {\n    container.scrollTop += top;\n    return;\n  }\n  if (top + eleHeight <= containerHeight) {\n    return;\n  }\n  container.scrollTop += top + eleHeight - containerHeight;\n};\nvar scrollToBeVisibleHorizontally = function (ele, container) {\n  var left = ele.getBoundingClientRect().left - container.getBoundingClientRect().left;\n  var eleWidth = ele.clientWidth;\n  var containerWidth = container.clientWidth;\n  if (left < 0) {\n    container.scrollLeft += left;\n    return;\n  }\n  if (left + eleWidth <= containerWidth) {\n    return;\n  }\n  container.scrollLeft += left + eleWidth - containerWidth;\n};\nvar ThumbnailItem = function (_a) {\n  var page = _a.page,\n    pageHeight = _a.pageHeight,\n    pageIndex = _a.pageIndex,\n    pageWidth = _a.pageWidth,\n    rotation = _a.rotation,\n    thumbnailHeight = _a.thumbnailHeight,\n    thumbnailWidth = _a.thumbnailWidth,\n    onRenderCompleted = _a.onRenderCompleted;\n  var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n  var renderTask = React__namespace.useRef();\n  var _b = React__namespace.useState(''),\n    src = _b[0],\n    setSrc = _b[1];\n  var thumbnailLabel = l10n && l10n.thumbnail ? l10n.thumbnail.thumbnailLabel : 'Thumbnail of page {{pageIndex}}';\n  React__namespace.useEffect(function () {\n    var task = renderTask.current;\n    if (task) {\n      task.cancel();\n    }\n    var canvas = document.createElement('canvas');\n    var canvasContext = canvas.getContext('2d', {\n      alpha: false\n    });\n    var w = thumbnailWidth;\n    var h = w / (pageWidth / pageHeight);\n    var scale = w / pageWidth;\n    canvas.height = h;\n    canvas.width = w;\n    canvas.style.height = \"\".concat(h, \"px\");\n    canvas.style.width = \"\".concat(w, \"px\");\n    var viewport = page.getViewport({\n      rotation: rotation,\n      scale: scale\n    });\n    renderTask.current = page.render({\n      canvasContext: canvasContext,\n      viewport: viewport\n    });\n    renderTask.current.promise.then(function () {\n      setSrc(canvas.toDataURL());\n      onRenderCompleted(pageIndex);\n    }, function () {\n      onRenderCompleted(pageIndex);\n    });\n    return function () {\n      var _a;\n      (_a = renderTask.current) === null || _a === void 0 ? void 0 : _a.cancel();\n    };\n  }, [rotation]);\n  return !src ? React__namespace.useContext(SpinnerContext).renderSpinner() : React__namespace.createElement(\"img\", {\n    \"aria-label\": thumbnailLabel.replace('{{pageIndex}}', \"\".concat(pageIndex + 1)),\n    src: src,\n    height: \"\".concat(thumbnailHeight, \"px\"),\n    width: \"\".concat(thumbnailWidth, \"px\")\n  });\n};\nvar ThumbnailContainer = function (_a) {\n  var doc = _a.doc,\n    pageHeight = _a.pageHeight,\n    pageIndex = _a.pageIndex,\n    pageRotation = _a.pageRotation,\n    pageWidth = _a.pageWidth,\n    rotation = _a.rotation,\n    shouldRender = _a.shouldRender,\n    thumbnailWidth = _a.thumbnailWidth,\n    onRenderCompleted = _a.onRenderCompleted,\n    onVisibilityChanged = _a.onVisibilityChanged;\n  var isMounted = core.useIsMounted();\n  var _b = React__namespace.useState({\n      height: pageHeight,\n      page: null,\n      viewportRotation: 0,\n      width: pageWidth\n    }),\n    pageSize = _b[0],\n    setPageSize = _b[1];\n  var page = pageSize.page,\n    height = pageSize.height,\n    width = pageSize.width;\n  var scale = width / height;\n  var isVertical = Math.abs(rotation + pageRotation) % 180 === 0;\n  var w = isVertical ? thumbnailWidth : thumbnailWidth / scale;\n  var h = isVertical ? thumbnailWidth / scale : thumbnailWidth;\n  React__namespace.useEffect(function () {\n    if (shouldRender) {\n      core.getPage(doc, pageIndex).then(function (pdfPage) {\n        var viewport = pdfPage.getViewport({\n          scale: 1\n        });\n        isMounted.current && setPageSize({\n          height: viewport.height,\n          page: pdfPage,\n          viewportRotation: viewport.rotation,\n          width: viewport.width\n        });\n      });\n    }\n  }, [shouldRender]);\n  var rotationNumber = (pageSize.viewportRotation + rotation + pageRotation) % 360;\n  var containerRef = core.useIntersectionObserver({\n    onVisibilityChanged: function (visibility) {\n      onVisibilityChanged(pageIndex, visibility);\n    }\n  });\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-thumbnail__container\",\n    \"data-testid\": \"thumbnail__container-\".concat(pageIndex),\n    ref: containerRef,\n    style: {\n      height: \"\".concat(h, \"px\"),\n      width: \"\".concat(w, \"px\")\n    }\n  }, !page ? React__namespace.useContext(SpinnerContext).renderSpinner() : React__namespace.createElement(ThumbnailItem, {\n    page: page,\n    pageHeight: isVertical ? height : width,\n    pageIndex: pageIndex,\n    pageWidth: isVertical ? width : height,\n    rotation: rotationNumber,\n    thumbnailHeight: h,\n    thumbnailWidth: w,\n    onRenderCompleted: onRenderCompleted\n  }));\n};\nvar ThumbnailList = function (_a) {\n  var currentPage = _a.currentPage,\n    doc = _a.doc,\n    labels = _a.labels,\n    pagesRotation = _a.pagesRotation,\n    pageHeight = _a.pageHeight,\n    pageWidth = _a.pageWidth,\n    renderCurrentPageLabel = _a.renderCurrentPageLabel,\n    renderThumbnailItem = _a.renderThumbnailItem,\n    rotatedPage = _a.rotatedPage,\n    rotation = _a.rotation,\n    thumbnailDirection = _a.thumbnailDirection,\n    thumbnailWidth = _a.thumbnailWidth,\n    viewMode = _a.viewMode,\n    onJumpToPage = _a.onJumpToPage,\n    onRotatePage = _a.onRotatePage;\n  var numPages = doc.numPages;\n  var docId = doc.loadingTask.docId;\n  var containerRef = React__namespace.useRef(null);\n  var thumbnailsRef = React__namespace.useRef([]);\n  var _b = React__namespace.useState(currentPage),\n    currentFocused = _b[0],\n    setCurrentFocused = _b[1];\n  var direction = React__namespace.useContext(core.ThemeContext).direction;\n  var isRtl = direction === core.TextDirection.RightToLeft;\n  var _c = React__namespace.useState(-1),\n    renderPageIndex = _c[0],\n    setRenderPageIndex = _c[1];\n  var isMounted = core.useIsMounted();\n  var previousViewMode = core.usePrevious(viewMode);\n  var hasRenderingThumbnailRef = React__namespace.useRef(false);\n  var renderQueue = core.useRenderQueue({\n    doc: doc\n  });\n  var pageIndexes = React__namespace.useMemo(function () {\n    return Array(numPages).fill(0).map(function (_, pageIndex) {\n      return pageIndex;\n    });\n  }, [docId]);\n  var chunks = React__namespace.useMemo(function () {\n    switch (viewMode) {\n      case core.ViewMode.DualPage:\n        return core.chunk(pageIndexes, 2);\n      case core.ViewMode.DualPageWithCover:\n        return [[pageIndexes[0]]].concat(core.chunk(pageIndexes.slice(1), 2));\n      case core.ViewMode.SinglePage:\n      default:\n        return core.chunk(pageIndexes, 1);\n    }\n  }, [docId, viewMode]);\n  var handleKeyDown = function (e) {\n    switch (e.key) {\n      case 'ArrowDown':\n        activateNextItem();\n        break;\n      case 'ArrowUp':\n        activatePreviousItem();\n        break;\n      case 'Enter':\n        jumpToFocusedPage();\n        break;\n    }\n  };\n  var activateNextItem = function () {\n    var container = containerRef.current;\n    if (!container) {\n      return;\n    }\n    var items = thumbnailsRef.current;\n    var nextItem = currentFocused + 1;\n    if (nextItem < items.length) {\n      if (currentFocused >= 0) {\n        items[currentFocused].setAttribute('tabindex', '-1');\n      }\n      setCurrentFocused(nextItem);\n    }\n  };\n  var activatePreviousItem = function () {\n    var container = containerRef.current;\n    if (!container) {\n      return;\n    }\n    var items = thumbnailsRef.current;\n    var prevItem = currentFocused - 1;\n    if (prevItem >= 0) {\n      if (currentFocused >= 0) {\n        items[currentFocused].setAttribute('tabindex', '-1');\n      }\n      setCurrentFocused(prevItem);\n    }\n  };\n  var jumpToFocusedPage = function () {\n    if (currentFocused >= 0 && currentFocused < numPages) {\n      onJumpToPage(currentFocused);\n    }\n  };\n  core.useIsomorphicLayoutEffect(function () {\n    var container = containerRef.current;\n    if (!container) {\n      return;\n    }\n    thumbnailsRef.current = Array.from(container.querySelectorAll('.rpv-thumbnail__item'));\n  }, [viewMode]);\n  React__namespace.useEffect(function () {\n    var thumbnails = thumbnailsRef.current;\n    if (thumbnails.length === 0 || currentFocused < 0 || currentFocused > thumbnails.length) {\n      return;\n    }\n    var thumbnailEle = thumbnails[currentFocused];\n    thumbnailEle.setAttribute('tabindex', '0');\n    thumbnailEle.focus();\n  }, [currentFocused]);\n  core.useIsomorphicLayoutEffect(function () {\n    var container = containerRef.current;\n    var thumbnails = thumbnailsRef.current;\n    if (!container || thumbnails.length === 0 || currentPage < 0 || currentPage > thumbnails.length) {\n      return;\n    }\n    var thumbnailContainer = thumbnails[currentPage].closest('.rpv-thumbnail__items');\n    if (thumbnailContainer) {\n      thumbnailDirection === exports.ThumbnailDirection.Vertical ? scrollToBeVisibleVertically(thumbnailContainer, container) : scrollToBeVisibleHorizontally(thumbnailContainer, container);\n    }\n  }, [currentPage, thumbnailDirection]);\n  var handleRenderCompleted = React__namespace.useCallback(function (pageIndex) {\n    if (isMounted.current) {\n      renderQueue.markRendered(pageIndex);\n      hasRenderingThumbnailRef.current = false;\n      renderNextThumbnail();\n    }\n  }, [docId]);\n  var handleVisibilityChanged = React__namespace.useCallback(function (pageIndex, visibility) {\n    visibility.isVisible ? renderQueue.setVisibility(pageIndex, visibility.ratio) : renderQueue.setOutOfRange(pageIndex);\n    renderNextThumbnail();\n  }, [docId]);\n  var renderNextThumbnail = React__namespace.useCallback(function () {\n    if (hasRenderingThumbnailRef.current) {\n      return;\n    }\n    var nextPage = renderQueue.getHighestPriorityPage();\n    if (nextPage > -1) {\n      renderQueue.markRendering(nextPage);\n      hasRenderingThumbnailRef.current = true;\n      setRenderPageIndex(nextPage);\n    }\n  }, [docId]);\n  React__namespace.useEffect(function () {\n    if (rotatedPage >= 0) {\n      renderQueue.markRendering(rotatedPage);\n      hasRenderingThumbnailRef.current = true;\n      setRenderPageIndex(rotatedPage);\n    }\n  }, [docId, rotatedPage]);\n  core.useIsomorphicLayoutEffect(function () {\n    if (previousViewMode !== viewMode) {\n      renderQueue.markNotRendered();\n      renderNextThumbnail();\n    }\n  }, [viewMode]);\n  var renderPageThumbnail = function (pageIndex) {\n    var isCover = viewMode === core.ViewMode.DualPageWithCover && (pageIndex === 0 || numPages % 2 === 0 && pageIndex === numPages - 1);\n    var key = \"\".concat(doc.loadingTask.docId, \"___\").concat(pageIndex);\n    var pageLabel = labels.length === numPages ? labels[pageIndex] : \"\".concat(pageIndex + 1);\n    var label = renderCurrentPageLabel ? renderCurrentPageLabel({\n      currentPage: currentPage,\n      pageIndex: pageIndex,\n      numPages: numPages,\n      pageLabel: pageLabel\n    }) : pageLabel;\n    var pageRotation = pagesRotation.has(pageIndex) ? pagesRotation.get(pageIndex) : 0;\n    var thumbnail = React__namespace.createElement(ThumbnailContainer, {\n      doc: doc,\n      pageHeight: pageHeight,\n      pageIndex: pageIndex,\n      pageRotation: pageRotation,\n      pageWidth: pageWidth,\n      rotation: rotation,\n      shouldRender: renderPageIndex === pageIndex,\n      thumbnailWidth: thumbnailWidth,\n      onRenderCompleted: handleRenderCompleted,\n      onVisibilityChanged: handleVisibilityChanged\n    });\n    return renderThumbnailItem ? renderThumbnailItem({\n      currentPage: currentPage,\n      key: key,\n      numPages: numPages,\n      pageIndex: pageIndex,\n      renderPageLabel: React__namespace.createElement(React__namespace.Fragment, null, label),\n      renderPageThumbnail: thumbnail,\n      onJumpToPage: function () {\n        return onJumpToPage(pageIndex);\n      },\n      onRotatePage: function (direction) {\n        return onRotatePage(pageIndex, direction);\n      }\n    }) : React__namespace.createElement(\"div\", {\n      key: key\n    }, React__namespace.createElement(\"div\", {\n      className: core.classNames({\n        'rpv-thumbnail__item': true,\n        'rpv-thumbnail__item--dual-even': viewMode === core.ViewMode.DualPage && pageIndex % 2 === 0,\n        'rpv-thumbnail__item--dual-odd': viewMode === core.ViewMode.DualPage && pageIndex % 2 === 1,\n        'rpv-thumbnail__item--dual-cover': isCover,\n        'rpv-thumbnail__item--dual-cover-even': viewMode === core.ViewMode.DualPageWithCover && !isCover && pageIndex % 2 === 0,\n        'rpv-thumbnail__item--dual-cover-odd': viewMode === core.ViewMode.DualPageWithCover && !isCover && pageIndex % 2 === 1,\n        'rpv-thumbnail__item--single': viewMode === core.ViewMode.SinglePage,\n        'rpv-thumbnail__item--selected': currentPage === pageIndex\n      }),\n      role: \"button\",\n      tabIndex: currentPage === pageIndex ? 0 : -1,\n      onClick: function () {\n        return onJumpToPage(pageIndex);\n      }\n    }, thumbnail), React__namespace.createElement(\"div\", {\n      \"data-testid\": \"thumbnail__label-\".concat(pageIndex),\n      className: \"rpv-thumbnail__label\"\n    }, label));\n  };\n  return React__namespace.createElement(\"div\", {\n    ref: containerRef,\n    \"data-testid\": \"thumbnail__list\",\n    className: core.classNames({\n      'rpv-thumbnail__list': true,\n      'rpv-thumbnail__list--horizontal': thumbnailDirection === exports.ThumbnailDirection.Horizontal,\n      'rpv-thumbnail__list--rtl': isRtl,\n      'rpv-thumbnail__list--vertical': thumbnailDirection === exports.ThumbnailDirection.Vertical\n    }),\n    onKeyDown: handleKeyDown\n  }, chunks.map(function (chunkItem, index) {\n    var isSelectedChunk = false;\n    switch (viewMode) {\n      case core.ViewMode.DualPage:\n        isSelectedChunk = currentPage === 2 * index || currentPage === 2 * index + 1;\n        break;\n      case core.ViewMode.DualPageWithCover:\n        isSelectedChunk = currentPage === 0 && index === 0 || index > 0 && currentPage === 2 * index - 1 || index > 0 && currentPage === 2 * index;\n        break;\n      case core.ViewMode.SinglePage:\n      default:\n        isSelectedChunk = currentPage === index;\n        break;\n    }\n    return React__namespace.createElement(\"div\", {\n      className: core.classNames({\n        'rpv-thumbnail__items': true,\n        'rpv-thumbnail__items--dual': viewMode === core.ViewMode.DualPage,\n        'rpv-thumbnail__items--dual-cover': viewMode === core.ViewMode.DualPageWithCover,\n        'rpv-thumbnail__items--single': viewMode === core.ViewMode.SinglePage,\n        'rpv-thumbnail__items--selected': isSelectedChunk\n      }),\n      key: \"\".concat(index, \"___\").concat(viewMode)\n    }, chunkItem.map(function (pageIndex) {\n      return renderPageThumbnail(pageIndex);\n    }));\n  }));\n};\nvar ThumbnailListWithStore = function (_a) {\n  var renderCurrentPageLabel = _a.renderCurrentPageLabel,\n    renderThumbnailItem = _a.renderThumbnailItem,\n    store = _a.store,\n    thumbnailDirection = _a.thumbnailDirection,\n    thumbnailWidth = _a.thumbnailWidth;\n  var _b = React__namespace.useState(store.get('doc')),\n    currentDoc = _b[0],\n    setCurrentDoc = _b[1];\n  var _c = React__namespace.useState(store.get('currentPage') || 0),\n    currentPage = _c[0],\n    setCurrentPage = _c[1];\n  var _d = React__namespace.useState(store.get('pageHeight') || 0),\n    pageHeight = _d[0],\n    setPageHeight = _d[1];\n  var _e = React__namespace.useState(store.get('pageWidth') || 0),\n    pageWidth = _e[0],\n    setPageWidth = _e[1];\n  var _f = React__namespace.useState(store.get('rotation') || 0),\n    rotation = _f[0],\n    setRotation = _f[1];\n  var _g = React__namespace.useState(store.get('pagesRotation') || new Map()),\n    pagesRotation = _g[0],\n    setPagesRotation = _g[1];\n  var _h = React__namespace.useState(store.get('rotatedPage') || -1),\n    rotatedPage = _h[0],\n    setRotatedPage = _h[1];\n  var _j = React__namespace.useState(store.get('viewMode')),\n    viewMode = _j[0],\n    setViewMode = _j[1];\n  var handleCurrentPageChanged = function (currentPageIndex) {\n    setCurrentPage(currentPageIndex);\n  };\n  var handleDocumentChanged = function (doc) {\n    setCurrentDoc(doc);\n  };\n  var handlePageHeightChanged = function (height) {\n    setPageHeight(height);\n  };\n  var handlePageWidthChanged = function (width) {\n    setPageWidth(width);\n  };\n  var handleRotationChanged = function (currentRotation) {\n    setRotation(currentRotation);\n  };\n  var handlePagesRotationChanged = function (rotations) {\n    setPagesRotation(rotations);\n  };\n  var handleRotatedPage = function (rotatedPage) {\n    setRotatedPage(rotatedPage);\n  };\n  var handleViewModeChanged = function (viewMode) {\n    setViewMode(viewMode);\n  };\n  var jump = function (pageIndex) {\n    var jumpToPage = store.get('jumpToPage');\n    if (jumpToPage) {\n      jumpToPage(pageIndex);\n    }\n  };\n  var rotatePage = function (pageIndex, direction) {\n    store.get('rotatePage')(pageIndex, direction);\n  };\n  React__namespace.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    store.subscribe('pageHeight', handlePageHeightChanged);\n    store.subscribe('pageWidth', handlePageWidthChanged);\n    store.subscribe('rotatedPage', handleRotatedPage);\n    store.subscribe('rotation', handleRotationChanged);\n    store.subscribe('pagesRotation', handlePagesRotationChanged);\n    store.subscribe('viewMode', handleViewModeChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n      store.unsubscribe('pageHeight', handlePageHeightChanged);\n      store.unsubscribe('pageWidth', handlePageWidthChanged);\n      store.unsubscribe('rotatedPage', handleRotatedPage);\n      store.unsubscribe('rotation', handleRotationChanged);\n      store.unsubscribe('pagesRotation', handlePagesRotationChanged);\n      store.unsubscribe('viewMode', handleViewModeChanged);\n    };\n  }, []);\n  core.useIsomorphicLayoutEffect(function () {\n    store.subscribe('currentPage', handleCurrentPageChanged);\n    return function () {\n      store.unsubscribe('currentPage', handleCurrentPageChanged);\n    };\n  }, []);\n  return currentDoc ? React__namespace.createElement(core.LazyRender, {\n    testId: \"thumbnail__list-container\",\n    attrs: {\n      className: 'rpv-thumbnail__list-container'\n    }\n  }, React__namespace.createElement(FetchLabels, {\n    doc: currentDoc\n  }, function (labels) {\n    return React__namespace.createElement(ThumbnailList, {\n      currentPage: currentPage,\n      doc: currentDoc,\n      labels: labels,\n      pagesRotation: pagesRotation,\n      pageHeight: pageHeight,\n      pageWidth: pageWidth,\n      renderCurrentPageLabel: renderCurrentPageLabel,\n      renderThumbnailItem: renderThumbnailItem,\n      rotatedPage: rotatedPage,\n      rotation: rotation,\n      thumbnailDirection: thumbnailDirection,\n      thumbnailWidth: thumbnailWidth,\n      viewMode: viewMode,\n      onJumpToPage: jump,\n      onRotatePage: rotatePage\n    });\n  })) : React__namespace.createElement(\"div\", {\n    \"data-testid\": \"thumbnail-list__loader\",\n    className: \"rpv-thumbnail__loader\"\n  }, React__namespace.useContext(SpinnerContext).renderSpinner());\n};\nvar thumbnailPlugin = function (pluginProps) {\n  var store = React__namespace.useMemo(function () {\n    return core.createStore({\n      rotatePage: function () {},\n      viewMode: core.ViewMode.SinglePage\n    });\n  }, []);\n  var _a = React__namespace.useState(''),\n    docId = _a[0],\n    setDocId = _a[1];\n  var CoverDecorator = function (props) {\n    return React__namespace.createElement(Cover, __assign({}, props, {\n      renderSpinner: pluginProps === null || pluginProps === void 0 ? void 0 : pluginProps.renderSpinner,\n      store: store\n    }));\n  };\n  var ThumbnailsDecorator = React__namespace.useCallback(function (props) {\n    return React__namespace.createElement(SpinnerContext.Provider, {\n      value: {\n        renderSpinner: (pluginProps === null || pluginProps === void 0 ? void 0 : pluginProps.renderSpinner) || defaultSpinner\n      }\n    }, React__namespace.createElement(ThumbnailListWithStore, {\n      renderCurrentPageLabel: pluginProps === null || pluginProps === void 0 ? void 0 : pluginProps.renderCurrentPageLabel,\n      renderThumbnailItem: props === null || props === void 0 ? void 0 : props.renderThumbnailItem,\n      store: store,\n      thumbnailDirection: (props === null || props === void 0 ? void 0 : props.thumbnailDirection) || exports.ThumbnailDirection.Vertical,\n      thumbnailWidth: (pluginProps === null || pluginProps === void 0 ? void 0 : pluginProps.thumbnailWidth) || 100\n    }));\n  }, [docId]);\n  return {\n    install: function (pluginFunctions) {\n      store.update('jumpToPage', pluginFunctions.jumpToPage);\n      store.update('rotatePage', pluginFunctions.rotatePage);\n    },\n    onDocumentLoad: function (props) {\n      setDocId(props.doc.loadingTask.docId);\n      store.update('doc', props.doc);\n    },\n    onViewerStateChange: function (viewerState) {\n      store.update('currentPage', viewerState.pageIndex);\n      store.update('pagesRotation', viewerState.pagesRotation);\n      store.update('pageHeight', viewerState.pageHeight);\n      store.update('pageWidth', viewerState.pageWidth);\n      store.update('rotation', viewerState.rotation);\n      store.update('rotatedPage', viewerState.rotatedPage);\n      store.update('viewMode', viewerState.viewMode);\n      return viewerState;\n    },\n    Cover: CoverDecorator,\n    Thumbnails: ThumbnailsDecorator\n  };\n};\nexports.thumbnailPlugin = thumbnailPlugin;","map":null,"metadata":{},"sourceType":"script"}